---
title: "ıe 582 hw 2 task 2- Q3"
author: "Dürdane Karabacak"
date: "01 11 2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```



```{r cars}
#Question 3
img<-readJPEG("D:/renkli.jpg")
gray_img<-img[,,1]
image(gray_img,col=gray.colors(20),main="Gray Image")


i=array(1:256)
m=array(1:256)
j=array(1:3)
k=array((-12):12)
l=array((-12):12)
patch<- array(dim = c(25,25))


instances<-matrix(nrow =53824 )
for (i in 13:244 ) {
  for (m in 13:244) {
    for (z in 1:53824) {
      for (k in (-12):12) {
       for(l in (-12):12) {
        
               instances[z,]=gray_img[i+k,m+l]}
        
      }
    }
 }                      
}


#A
plot(instances[,1:5],col=2,pch=".",cex=7)
summary(instances)
cor_mat<-cor(instances)
View(cor_mat)

pca<-princomp(cor_mat,cor = T)
summary(pca,loadings=T)
plot(pca,main = "",col="yellow")
title(main = "Principal Components Importance")

loadings<- unclass(pca$loadings[,1:3])
loadings

#components<-pca$
biplot(pca,main="",choices=components)

scores<- pca$scores
pca$scores[,1]
pca$scores[1,]
img_new <- array(0,c(256,256,)) 


library(EBImage)


img <- array(0, c(256,256,))
for(i in 1:256) {
  for(j in 1:256){
    n = (i - 1) * 256 + j
    img[i, j,] <- as.vector(pca$scores[n,])
  }
}


```



```{r pressure, echo=FALSE}

```


